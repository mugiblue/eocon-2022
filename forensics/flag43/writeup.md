# flag43

## Analyzing the PCAP

Our first approach was to look for unencrypted data streams, such as HTTP.

We discover a request that contains a PGP message.

<img src="img/message.png" alt="message" width="700"/>

When trying to reach [https://sela.io/pgp/](https://sela.io/pgp/), the website seems to be down, so it looks like this challenge was made a while ago.

So now we know we need to find the key and passphrase to decrypt the message.

By running the *binwalk* command on the PCAP file, we discover that there is hidden a PNG file inside:

```bash
└─$ binwalk capture.pcap

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1131          0x46B           PNG image, 200 x 200, 8-bit/color RGBA, non-interlaced
1172          0x494           Zlib compressed data, default compression
8615          0x21A7          PGP armored data, message
109396        0x1AB54         Zlib compressed data, default compression
```

Now let us try Wireshark to see if we can extract the PNG file.

Basically, we can try to look for the PNG header in Wireshark. We know that this value is *89 50 4e 47* in hexadecimal.

<img src="img/hexsearch.png" alt="hexsearch" width="700"/>

Now that we know the source IP and protocol, we can filter it in Wireshark using the source IP and protocol.

## Retrieving the key

We now see that the data begins at offset 00e0 and ends at offset 01e0:

<img src="img/pngstream.png" alt="hexsearch" width="500"/>

(This, by the way, is the end of the PNG file, signaled by the IEND chunk).

We use Wireshark to extract the bytes between 00e0 and 01e0 to get the PNG file. We get this hex string:

```
89504e470d0a1a0a0000000d49484452000000c8000000c80806000000ad58ae9e000017e449444154789ced56db8eec3cab5cefffd2b3affa9737aa13e96f4ca4a1a4561207438129d2ff7e168b05c5bf69028bc59bb102592c0456208b85c00a64b11058812c16022b90c5426005b25808ac40160b8115c86221b002592c0456208b85c00a64b11058812c16022b90c5426005b25808ac40160b8115c86221b002592c0456208b85c00a64b11058812c16022b90c5426005b25808ac40160b8115c86221b002592c0456208b85c00a64b1101811c8bf7fffe8afdad57b648bf69df62ca6f25dd7baef15379523db8be222fe281fc54dd587ed653628bf244f94a3ea8b9b1813885a7f7ab0d577a7e1149727b9a0f8c95a6770a07ab1188cabaa9fcac9fd1c5725f484f72d8c0ac44d2137a1dc34af36c944ac7e2ae71a1bd9ab8356c24c1b38157ad294d50e5d51be0c4e1c2adf94ef4dbc5220c8be332d539fc9bab34ba7692a76c6c14d68e5837148f8a603cc714d874ef581ec6ee295026113b1da9c6b49b1d38343319540d338750faa81b3490599f056b19defca11adb3734dcfffcf0b84ad27938ef9730da9de29f17426a0e3e2f8265c5c1cf63e1150ca09ad2b2e6e3038fe13181348326df7faf7aeaa2f26301759804d225528253237f1d844aecf6ac2a9382a36b343311c3fc591d9b13a27f9307fee9e71782346bf209f7bb47e3e274da67cabc9a484e8b8a1784a00ae195da3bb3c180fc64135685a2bc4d70d1214c3719cc258f424f14ed39cef9580aa1df3dd3d9ca489584e4ea44e10cebff299707a128f0d2fb49f41c5bd855179b2c65636e73a2b20f25b7db869ce62257bdda44cd693baa8e9cb6a944c6817df0d81642fb2717c27f08a2f889b6668fd5c6307aaf620ff95178bc3fcb97bd5d46e0dd52e191acec6894a0d1bd5fcaa06e81daa2bf37b13239193a64ea61b3b5865df6d54777f5e139e8c2fe38d6ac678247b9528543c96a7b37522ab3e5cdd6e635420ac50c806ed47ebccbf6a66b5df4d5a66affca178e8ca724e1ad50d9b6e4e35aeca93715350673789d1bf586c8274264b3ae5d8bb4ee324fb2b47f5be2bfea436ca078ba16a9b88a2fa61f61d512679dcc02bbe209f356597364322a4548c751df96536cc27cb25b561f7e9c4754267f55676ccb7cb4b0d0ac7f716c60472de2b01201bb7f77c8762ab66637e95081d6f5503276e27009587e2e18497f065ef1261bbfd8ecf2d8c7e41eabd7bf75943f7e7336be81a23693c76df11a0ca53350cf39788cbf9a8ef581e0c495e9db355f59fc4f817e45c4b1a83351ff3dd6940352519c7277689389d285df3b1386a1fe29bd445f942362a2f6537815181b883575756e8f3ca62a7130ef96282ea4e6cd5b48c8f6b7c87647a2b5fc92061034d89a033f06e632cba6b3c37f9d5deba56edd43e162fe19770638da2f82a7bf57ce6e08606e3e144dec94b890471613637f18abf586a8a279396f9604de738d4d8e87dba0f71537e92af0313b3cab3339094d0980f163311be8b3189f1bf589d099f1c80f2edf6fe579cd1de74c276ec131fecdec570be51aec85e895d89bf7b3ebf85f1bf589d2275a66ada742e8e8a973648e5c71a9771473193f7cc571a9fd589f1ece695ec9b14c7cfcfa040fe47c01455d9a886acf6752d39ecd4d7933cd349aa9e55a3b158c847c289090cbd4b060ee393e47e13aff882b0f7aa30c9e1a929eeb8a9e986fca7e2e94e6c65e306891310f281f277bf84b7b2ed0afb264618740e2e692465d79ddcd567da2c2c961298bbeff262b1d37516df9d4bf5c5f6a567c2fc4d60347ad218df347812bb3bbd59b328d1a869ce7271e263fb544e691c957b27765a1757ff498cffc5fadcb3429eb649b3d418ce77b5557b19ef24969b928a1bca398d816aa2de27b1129f6a2838b12851dec6e85faccfbd6aecd33e998aae71aa3f253065e3c48af24862741a11c549060fb3415c58fc2ecf8e00dc79dfc4e8172469b64ed3323be75f09d635ae12249b988837cb53f1750d9bc64dfc238e5ddf2abfe43a81b12f886a0e37515453a218c9c1aaf88edbd3498a7262fb5dbd98c81311a11c199f4eb3a77549443685d12fc8e7ca7ea71ddacf26bdf39bc4735c58d3a7bed1de247e278eab7dad632a2ae64fd5c7c57f9acb6fe3157fb13ecfe7fad329e384c3e2abbdc9733231531e8c7b528bee7a92737a26d59f6afaeeb099c2e85f2c55346557af9d6226cd964c78e42f692096d753ce49fe2a07354cba5f06c639ad07daf7e705723ea37bb457d975be1ec9e4568248f2eb4c4ec42da947278eda93bc4fc5a36ae1864ee2f71646ffe0b9e9e79a3d998cc81ec5ae7b3a87ea0e50e5c5b825f6759f8adbf92a240d9b0850d9ba0199e47703a302f9f9d1053cafa7ad3bac5470c9a1779ac71dbecaddd93391a6e256bc3ab932a4824b870d3bc3db788540d27bf50560879d4c3bf68ef953b9288ec856e5e8de7545ec868e132c131fab8d1b6ecaa7cae52646a2bba2769a3c9d824e280907669bda258dc9f829ff2e97c446893a1549c74fb5497299c09840ea95354b3259cf6725a42406b255be983de3e9a6accb4bd541e58bfc381f6abdc357e58afc39ae37311639f92a9cf74f2657ddcf7c2a8e287637a7845b226cf7ded584e5ec9a51ed49071b3b0fc7d1d5fcb7f18aef999b369fe7e4209c4fd500dde98f7825fe1db7240ecbc98905c57739a8f5c48ed9b33d4c5c1378c517c435319b2c752fda9f344bd254ca3ee5c6724f1a21c953f9afbcdc844e064f477488a3e2f4168c0aa45ed3c9a38a9f36bb9bae95936ba4ea933d3b28a1a5b5529c3afb551ddd193c8d55f74f6394892a8a6a5cb65f89a1fa50a2615c557cb5bfd3702e1e43523f3510541edd0657ef3ab1df209891c8aa61ce75e7431d62d2784983bb18aa1112b1a50d86ae954357a0ea5d9a97abbbabbf5b4b7ae137312a90f33e3d2865cb62a0f849b3208e4f26b39ba02cb7ca85c5ad6b287f269c540cec5cd2fc9d3fb6671a632c5c33b1833eedea3df2c7e2b2c35231d41e274805d568091794971248c259f17703a2f3ccf278c2f337f00a81d4f5cec44926913b884eacbabf6b9bf0727b9f72487e492c6783ea9a0ca4ba0fe5711b637fb15463b8e2235be657f961fe981f9703da9ffa5279299e2ca6f297da306ecad6f96679a9da4d62f40b9234b92b585a70e6dfad33ee2816f3a7a634cb434dd42417c599d9a83d2a1f27bee43c5cec298c7e413ef7e79a2b206bb4644abbc65613d071af7e931a207fc9c447fb13e17727b312767286ae2e8eabda7b0bb3dfaf036cb23e5d4b0fb7da335fcc3ff3e1262bf3cd26aee2a6c4ef84a3f8d7582c1ef397e6c77c4f0ae383577c419209a70ac7f62adfaa81115fc75df170fe514ee75a379f846fc7672a0a25e4b45e2e9fdb188b9c16921d3ab36507899ed306508d55fda1fd2a7f951f8aa5f2496226cde7f24984ce8604e3a4f299c4d817043dabe643b64a28897fb587d9339f491e4993bb6667c254f540f118cf344e32d458aecc5ee53385d7fcc552efcfebf95e35b9f35f7d329e6c0f3a5c3771130133fb6468b8fc923ab9384a68c82e69fa84e714c6bf209d46af7b90dfa4c9dc3455be503c954b5daffb581324be53e1a82675754aebc7f262f1d03e37402630fa05715382159cf960d7ead3f97762ec361c8aa59a9f71539c506eee5d32501047c61bf14d6ac0eaa272bd85f96fd88f6f1064cff6aa29a49a57ad233e89c09d4fe5478912f1417119f74e0e29b7f4dcdc592543ee26c6a2ab697ade77268a9a5c75bd2318e5339d8a6eaa26b9a63eab2d5b53a2a96bcc9eed555cd33d6fc0388bb401d93b6493347f271eb2673c905f3504583ddce44e4497e4c59a51d5d1d59ae5a3b8a9bc26312e1087e4e099edb9d611187ac7eed9745507ad1ad5f957f9bbb8e819c1e5856c9d78183735bcde801116aa713ed7eea4433e546cd7f42c5eca53ed47be127f28e794635203d7b04ef0690d947f3628a63016d94d0b75a8eefe9bd8ac6958bce42ba1f628bf6ab2aadc554c165bd9b31a55a85a315f6cff5b30ca061510d9b8e9d939cc74ea275330111acb57e585ec133f8928bf797675486a8fe0ea31299a71b9bae4bb4d98fa7c3231d3265693ddc5473c5903a539aba9ce7cb1e193ec53bfa42e2ac66d8c445707a59af1b47713d81d407228c9a122bf6e22aa3aa4beba3e5dcd5cbdeb3dab676a87cebfda327f3731fe05f9f9c90ac09a5a35bb9a969d095ce3a367649b4c4cb457f9732275dc95a83a3fe75f9d45d7f6cf09c44dd9a458c9619dfbd97d32fdd81ec59fe55b63760edf354ca76e2ad774e0a8a191e4e886c80a0414309dbec896c570d33379a7d6182fc751c5bf1187d54de5ac62aabd8cafe3fe670572de2793065d953f76006c8dfd985f76a86a2d69d22e876e0dbbcf4e44aa795d6d52ae931863a20aa5a669f7ab507dba49abb8a582490557fdb01c134e9d1a20fbc446099471efd8aaf5298c0a4415efbcd67d6c7fdde36ccf772a06f2cdfc230eaad192ba309faef1ea7a8737db837cb03d2e7eca7712e37fb1d0f3b99e4c1fd530c80ff3ad1a22cde19ba98bd6918f4ecd502d92bcd44071ef195f9713e33729963181a8064da71a5a737bd5a17439b81c14a764c2b3fc947f964722485723976b12d7e5b802f9043693a6daa26bf2ce4d6877684a4c282794836b5e74afea940822a993130ff3efde257e1381a178b7312e90cffd7945ef5df3ba83457b6a6c272eb48ee2a25c6b7e2e1776756255fcd4baaa518d9d36ad1b4209afa4bebf89b1bf58e77d7762329f4f6dd521a23d68bd6bef723e79303fea19ad77fcb801c16275eb5af7a1187f4e20ff8f4030f1949db27131d43453f1ab7d12434d5f97c77ff1aec6435c3a39a56756e3a89a2bce531865c20aa2a6a89a2c69c1dd81b16764cfa61eb3550da0c487ae8a472747d7e0280eb375c3450d0fc677523063915d7191ad3afc7432d72b3b28d5344e7889b8eb1e153fcd87810915ed550dccea8438777876cee5365ef12d4b27959ac8df341af287f677275d3295937c901d8b83e23d157b22502704965737f6144658b8623d6900e49ff94edeb1b82846ea8b71409cd9bed417f293d426c94735af13405744d318ff8bf5542cea5ec561f6ae693bb9207fcc5722e0b42ea990ebbde286ae091f16dbe5c96ca730fe0561454a0aa61a81eda9efd1b36b3eb7cf35a1f3e1849a882de151f7383139bba7c3cc9ddd24c6bf61ae08c9543d6deb1e576837a5934676fe541e2a0e6bf6faac9a8ff153a246b64cb489e09273a8fbdf82b12f48bd578d85ecd89464cf9de9ea1a03e5c162383fce1ec551f564b977f7d775276494931311db837c4c615420ec60cf7b77f8681fb34f0edcc5428d8d72ea4cddcadf4d772738e7c7091bf152f9a167c44571ab3c3a03e23731fe05399fd5ba3b28d7c8ee60d3c9c5fcaa3c5d7e8817b267768cb71b0ca9d853ce4923331b75067f522049a13ecfe755d9b903adcf49f3247cd51a6bfc274382f956cdae7825fc512ce543f15375e8d4f7264605820eb75ed5bd9bd0ca16dd3bc1a8bd28bee2e972763c937a227edd499d0e0015d7ada55c2630caa2d3586a7aa5824bef134eec5d32e999f099ade297d40ad9a31c544eaeb6a9f8d419221e6ced16c622bb89c344a1d691af7422bb86657ed95a5d4f6323b0986e18a8985dbe4e608a33e281b8a85ca7f09a2f483291ce7d9da665fbd5c4737cebba1364d2888a17e2c1f2ef0c0fe493d5c40dac34470677a61318ff82a48754f7a8866257d7b449633d6d16d748a83e1daeae66ae168827caddc563ef551d586e6c20ddc46bbe20681dd9b189d26908b556e3a843ea4ce234c693fc504e2e37b5ef5b5b270c97abcbe526c6bf20e8591d6eb5573f14cf4da764ba2a6e2a2f950faa018bdd9dc82a97a4495341a0988a07aa8fabdd6dbc4220aca0ead055e3219f49e3225f491325cfaa11127e2e7e1a47f9aab11381a87371ef55fc94eb6f63247ad2f46ee2778453dfb1e664f1bf99de6e5277f8ab9c906d3a14d40477bc583c2654f63ed933813181740aa84451f7d7bd2ea6131ce384f677262fe2cdf8a7cfc9106079a9bab9982a47354010d281710ba37fb1eab32bac3abcba473510f3911cbab3ebe68bf270f649aece86f9513fc40be599f0417bd233bb89d93f783f7e12b1b57a8f9e6b0c66eb0ed0f14f9f95b8587eac516b5e4e002ee724667a4e4e5cee3c2afea4403ac54da74e7d97d89d57749ff261b158b32a2e9dfcd99e044a944ff249c585fca0dc10bfdb788540d8643bdfbba9a8a614f3d59962296fb54fc5554d95349dba4fdfa31ab1fc1c471593e58efc25b5fd4dbc462049839cfbaa0f172b8dc3b8759f5943205e2e07c5eb89481201b938493e4a84ccbfaaef04c60552ef3fcfaac075cd89289d86684d4dc1248ee2f94dce8a6bcad3d52b3917553be6db092e1d1c3730125d1df0e79a8882ad7726d7e923b5678d9ee6a17261b6dff0638d99d492c5793294dcc04886d26d8c0a44359a2b4a3a89cf78c95ec48ff960fbd07ae29b3571c245d52b1928290797bfaafd9338e8f926c605f2b9aa0987f6323f5dff2c869a664e08493c256e748fec5473abda293bd4d0ec5c3ac308e5a56aa6ea7413630249a64ed220f57dc75f2a4c1507d9a79c5c0d120eea7dc293ad21ee6eb8b861c07266e2780346592413504d95e4fd79ad71cf67e6bbda303f8a93db97344722986aefec54cd948de2900e1be707bd9fc0b84cd541264d991e2e7befbe021dd13891a8067fd2c86a18a8daa87bd58c290f2518c693c5739c7e1baff98bf5b9af6bcce67c77da741a441d809b8a8827b3ef0a95c54ff92435613f573b85277c908fe47c6e615420e901b803ae7e9d1ff4ac2621b3ebfc5cfe490d94b0d000a8cf49a3a5e2521cd579a9788cfb9f14c879df997c687f5d3bf7a07b14d73558e7b01d8f948b6b2815efdb864639295177c4a7f6b801751b73913f04c8643caf759ded75d3346916162be1ec9a1ff1fc6640a8e6addc104f354412b1327f6e90b99f8a771b632c5c814e1be7c7ad7726b29a60a9b8548eca86ad29b1291eaaf913deca07bbba2185f6b1b86f10cbd85fac4414ec20d326508de7a6652a1cd5646e3f7baf78a1abab4bb5e9089e7160762a06aa552ad0298c46ef88c33521f277beab315ca3b335e6a3c67282507c582e9dd8aa168940116a6c2754e72be1fb6705c20efaf3eebca27dcc473215919df38bfc295bd74c4ed4aa269d78099fa42e6c8f13371b1a2a5f96fb04c6bf20e7bd2ba63a042796548cc8976af2a43151de2a5fb687ed571c548c27fc5de327f5757570b5b889d12f08ba3fd7d8c4a9ef95ff4ed39ef64c1035be120ee39a08c44d69954b7ddf69b22417153f15b2e2e97ae326c6ff627deeebda6977be53cfe715f953cd87de331be4aff2551cd5fba439589d5c2e2c3fc41bc574393c69fc4e7d26301239993aecde0980ad2b21a5fe3ae260b1928641bc587ee9b572568dc7deaba1a4c4c9ea836aa2f29ec098405cf3305b57ccf3bedb084e002e261368b56536ecbd129efa32a84676cd8d38a60301e5a2f24af399c0f817441d50b5770dc3ee3b079e344cdadc492e8837b255224804c9ea9036201b22896f9673c2e5cf0aa43bb15023a4539a4d2de50bed57cde1a667d22cd51e5d9fe6e5c4edf8a85c9d70956f95df1b30c6c21d646a8fee5db15963a978689f1337ca81bd675f09252af795506b2a267b5f7d75ce8fc55379bc4128a3d193a6386dd9de6ae39a9bf150b192772e5e22b89a07b2ef8a5435667a9f0ad6e580dea973673e6e61f40b72de3f9946d58635724778288e6a0c96879bb82c8ecb4971508dcb62226ec980e8888dd9a7d73f299013c9b4aaef999f64fa75276e7dcf6c9249eb38202ed54ee5a58680ca4fe5963477a7569ddf34e61900a00376cdabdeb98661ebea8054c3303e8910d87b14b7c385ededc6a9b6497e6a08b1d8d5f7144622a713eabc57cd773eb377f58a0e99d9a8c676f19203765c3a71544d937d9d9a2811b17bb5e6ce6902630271eb6a5aa975f65ce32422623c92982e9fa4395da3ab3829af8a44a08e67f2537cde208c0f4605c29ab4be734566cde3266c1213f94df93d1105ab938be9eaabf2acf113beaeee698c4e9c09bc5220aa31eb3ed5f0f5d9f9451c9eec7b22687655bc1007c52f1109b2efd42b1d406c4f32386ee2950239dfb17dd58e359d7baefed8733269194fd7dc2a5ee59dc4fea60193fa7491889a71fd2fe27f835181b0757490683d69fe641f8bdd6d7a1547d9a6768c0baa215aefe4aff2795a6bc485d9bc05630261bfcf7bb5efb449262d6ba4b4511027d6b04efcceb7128ee2cf38d578aad9532138d1baf3ecc699c43b65bb58bc042b90c5426005b25808ac40160b8115c86221b002592c0456208b85c00a64b11058812c16022b90c5426005b25808ac40160b8115c86221b002592c0456208b85c00a64b11058812c16022b90c5426005b25808ac40160b8115c86221b002592c0456208b85c00a64b11058812c16022b90c5426005b25808ac40160b8115c86221b002592c04fe0f7ec7ad0dda2944750000007a7a5458745261772070726f66696c65207479706520415050310000789c4d8a5d0e80200c83df770a8e30060c3c8ef263488c1aeeffe01442fc96a64b5bd8f3995b8dea6e57a94706f5c101acf3811766146cb2099156ec0491418d599c46b67533849a7adfd13047a4cdbf189a7060c751ae782f22f9ec9bc303083f239844ed06e20000000049454e44ae426082
```

We can use an online hexadecimal to PNG converter like this one ([https://codepen.io/abdhass/full/jdRNdj](https://codepen.io/abdhass/full/jdRNdj)) to get the image:

<img src="img/hextopng.png" alt="hextopng" width="550"/>

You can read it using a command line or use a QR code reader on the Internet (like this one: https://webqr.com) to get the PGP private key:

<img src="img/qrcode.png" alt="qrcode" width="650"/>

```
-----BEGIN PGP PRIVATE KEY BLOCK-----
Version: BCPG C# v1.6.1.0

lQOsBFvO/9wBCACgT4fK4dJm+M14jotXPUeKueo8xfFDunNUx/ZaSQbp5Y0i64OZ
dPkQk4E2zCgXaYKNRhiIx2RUy27GBf7xjtDb0gh/HNhC41f5ZzYrNQBEcabcr0hn
VfwiEzAqmTg+5TNsG26ZD2kuO1/J5zbKxI1D3g/9//fe5Nw8GucDiOntKgvFEXeV
ETZ0llbP/mh8SAn5+naJiJJri9y3GF+QhX7wYP+W6mBkano8X/Yk2B2qWIRT6wRU
DMQy1ptavyv5EJhYbsQGeAMu7WPJN+mLutAE2E1Xj03Sevsx2ynN8b/jF/HYp/mZ
SzZ+TbHlRUoMC4+hYh5XfXy7Cx9HSI0uIDShABEBAAH/AwMCEv0ZoXbeXxxg3ioH
/Y0lUhYOormsNzbrBjl1ipyWTDmRAf9BhmAPrX9K5GPAFAurGOj8QOQEWGrOyXfk
gYtHXzGk1K6ItCitgxdBqHgbti23Ht8SmVWw3/pijPXXerXXMqj6NQ95ma6bYPsU
PRtE1qtiEs+T8ln6ZBU9BCNyuZDceBY6btZS0cp88wB1xEPorhXVtjiV1cjDRSFG
licqXh4fr4Qe0TUEeZK1uTqlhdj6YvKoFP94OKGxeM0eR1R/H/zyOtJVMMsEZLGr
GNSVBZBN0B6l9wAMa+DGpuHIX25I197vP3x0v0gvP/57bF9og9mj2JzntM9NJsR1
2zAgplgX4IUp4SGPvcNbLE5c9yIEj77SAOBumrF3IcUYNN9IXvIHQh8qzOWmI5q+
NFCKin0tQNCAx4ef+4ThkyPezRovlFxG6T4HMF1YjYrlVMgiN034opaCKoFXd3EF
4UufN3vV0IYB7AfxWLeNAJyPCreDSyYyLFGx+ONpM5JKk/1cwH8H0XQuLXY+TuGj
iF6QWkRkVcAYv0F7r2wPaVOVa8465s34fY94Rv1+KCpsjNFc3FrAJhz84jETxxqr
s44U/zmGh0/tixjs9vB1C/i7csYWXYJYiPsPmcp5sOE4M1PtYsIfuOlaJ12e/IV9
YnNK+RLghYQ0MghUMHZeg8aqKY7SATDB1SuK+YKmhXte/E/VhTBUy+3RautMIUwS
w9R1z2Hh4POZ4kp8yj9PnEujoQ5XtZuruhNyiWEwWYf1GPuDSoeEYcIRj18h8dL+
OSvsS1DqgPxH9hy8iidLDq1ZkrQ0w08Du9zjVY02f4OoRunzXbis6P3Y0mRf4iif
bYdqVg3snMwY5u9lEaIYqmtcGibgybah394CgTt0xrQTa2FydGlrOTk3QGdtYWls
LmNvbYkBHAQQAQIABgUCW87/3AAKCRDH1z/t9n8r4qnlB/9N1BBWSf6lfmejPh3R
DZ+QrBsCELm8qBeawlsY9To6UUdrIoC9vzIwKAgil2K2MC9z/laZQcep0WepnOar
5KSUyhPI50/aE97yfA0v4lKkylb0OPt8E0S4gIxTlRhpht2K4lsRaD+2wyRvMRuU
/Grgxd5TVVm9KfXQBCAxgFgX2OdZ2/Yb2GJQ4M6DquISIBar+i39a9bdZ9kP70ox
jfgG8SLXPxzBiHIULUy4X+80VafKWw1/AzN2t4CTRtIMHu7jeUqpws+MB6TxTLBA
G/JSdb+W3ceHseJ9YXqVIhfrlKt8T3QAqErjQjPN0YB9KDaELwDM1rxFryy8zuAB
zdZ/
=rb5z
-----END PGP PRIVATE KEY BLOCK-----
```

## Retrieving the passphrase and conclusion

[https://sela.io/pgp/](https://sela.io/pgp/) is no longer available, but this is not a problem as you can use the gpg command to decrypt the message.

When trying to import the key, we see that a passphrase is required.

By running exiftool on the image, you can see the message 'helloworld' in the Description field:

```bash
└─$ exiftool qrcode.png    
...
Image Description               : helloworld
Resolution Unit                 : inches
Y Cb Cr Positioning             : Centered
Image Size                      : 200x200
Megapixels                      : 0.040
```

We try and it works, we can import the key.

```bash
└─$ gpg --allow-secret-key-import --import key.gpg
gpg: key C7D73FEDF67F2BE2: public key "kartik997@gmail.com" imported
gpg: key C7D73FEDF67F2BE2: secret key imported
gpg: Total number processed: 1
gpg:               imported: 1
gpg:       secret keys read: 1
gpg:   secret keys imported: 1
```

The last step is to decrypt the message:

```bash
└─$ gpg --passphrase="helloworld" -d message.gpg
gpg: WARNING: cipher algorithm AES256 not found in recipient preferences
gpg: encrypted with 2048-bit RSA key, ID C7D73FEDF67F2BE2, created 2018-10-23
"[kartik997@gmail.com](mailto:kartik997@gmail.com)"
flag{eNcryP7!ng_t0_PgP_1s_r34LLy_Pre3tY_g00D_pr1V4cY}
```

The flag is:     **flag{eNcryP7!ng_t0_PgP_1s_r34LLy_Pre3tY_g00D_pr1V4cY}**